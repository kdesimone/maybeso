% figure2b.m  Generate panels of Figure 2b in Pritchett and Murray (2015)%             i.e., experiment 2, proxy decision space and GDD function fitclear; clc; clf;% initializeaddpath(fullfile(pwd,'tools'));  % add tool folder to pathassertstats;                     % check for the statistics toolboxfigure(9)subplot(3,3,1)% choose subject (subject = 1 to 9)for subject = 1:9    fname = sprintf('data/experiment2_subject%d.txt',subject);    fprintf('processing %s\n',fname);        % load data and select columns    trials = load(fname,'-ascii');    signal = 2-trials(:,5);         % signal position:  1 = left, 2 = right    sigcst = trials(:,4);           % signal contrast increment    rngseeds = trials(:,[ 6 7 ]);   % random number generator seeds    response = 2-trials(:,9);       % observer response:  1 = judged increment on left, 2 = judged increment on right        % calculate a radially pooled, unit-energy classification image    fprintf('  calculating classification image ...\n');    [cimage,cbin,ntrials] = calcclass_experiment2( signal, response, rngseeds );        % calculate proxy decision variables    fprintf('  calculating proxy decision variables ...\n');    dvar = calcdvar_experiment2( signal, sigcst, rngseeds, cimage );        % calculate proxy decision space    fprintf('  calculating proxy decision space ...\n');    dspace = calcdspace( dvar, response );        % extract data    x = dspace.dlist - mean(dspace.dlist); % demeaned    y = dspace.pmat; % measured pmat    n = dspace.nmat; % number of trials    k = dspace.kmat; % number of responses        % fit functions    fitfn = @(x, p) 1./(1+exp(-(x-p(1))./p(2)))';    errfn = @( p ) -sum(log(binopdf(k, n, fitfn(x,p) ) ));        % fit    [ pfit, err ] = fminsearch(errfn, [0,0.25]);    yy = fitfn(x, pfit); % fitted pmat        % plot    figure(9)    subplot(3,3,subject)    scatter(x,y)    hold on    plot(x,yy,'r')    xlim([-1,1]);    ylim([0,1]);    title(sprintf('mu = %.02f, sigma = %.02f',pfit),'fontsize',12)    if subject == 1        xlabel('dvar','fontsize',16);        ylabel('probability','fontsize',16);    end        end